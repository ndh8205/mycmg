function q = DCM2Quat(R)
    % Shepperd 방법
    trace_R = R(1,1) + R(2,2) + R(3,3);
    
    if trace_R > 0
        s = 0.5 / sqrt(trace_R + 1);
        q = [0.25/s;
             (R(3,2) - R(2,3))*s;
             (R(1,3) - R(3,1))*s;
             (R(2,1) - R(1,2))*s];
    else
        if R(1,1) > R(2,2) && R(1,1) > R(3,3)
            s = 2 * sqrt(1 + R(1,1) - R(2,2) - R(3,3));
            q = [(R(3,2) - R(2,3))/s;
                 0.25*s;
                 (R(1,2) + R(2,1))/s;
                 (R(1,3) + R(3,1))/s];
        elseif R(2,2) > R(3,3)
            s = 2 * sqrt(1 + R(2,2) - R(1,1) - R(3,3));
            q = [(R(1,3) - R(3,1))/s;
                 (R(1,2) + R(2,1))/s;
                 0.25*s;
                 (R(2,3) + R(3,2))/s];
        else
            s = 2 * sqrt(1 + R(3,3) - R(1,1) - R(2,2));
            q = [(R(2,1) - R(1,2))/s;
                 (R(1,3) + R(3,1))/s;
                 (R(2,3) + R(3,2))/s;
                 0.25*s];
        end
    end
    
    q = q / norm(q);
end